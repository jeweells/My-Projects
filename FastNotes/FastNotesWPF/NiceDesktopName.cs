using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace FastNotes
{
    public static class NiceDesktopName
    {
        /// <summary>
        /// Random adjectives to add to the desktop names
        /// </summary>
        static string[] names = new string[] {
            "Strange",
            "Terrible",
            "Chainlike",
            "Convivial",
            "Fan-leafed",
            "Affordable",
            "Popular",
            "Fabulous",
            "Irritating",
            "Shiny",
            "Comforted",
            "Wonderful",
            "Skillful",
            "Average",
            "Exceptionable",
            "Arrogant",
            "Lazy",
            "Biting",
            "Wasteful",
            "Respectful",
            "Gorgeous",
            "Vicious",
            "Ferocious",
            "Good-for-nothing",
            "Loving",
            "Cheery",
            "Orange",
            "Illogical",
            "Stoic",
            "Vast",
            "Cloven-hoofed",
            "Course",
            "Childlike",
            "Splendid",
            "Hushed",
            "Soulful",
            "Persnickety",
            "Soft",
            "All-devouring",
            "Black",
            "Well-behaved",
            "Comfortless",
            "Great",
            "Furry",
            "Crease-resistant",
            "Reclusive",
            "Artificial",
            "Persistent",
            "Slight",
            "Closed in",
            "Crushing",
            "Scary",
            "Certifiable",
            "Lithe",
            "Hard",
            "Content",
            "Faint",
            "Pretend",
            "Poor",
            "Famous",
            "Impressionable",
            "Fervent",
            "Small",
            "Creative",
            "Vivid",
            "Hope",
            "Helpful",
            "Bloody",
            "Heated up",
            "Joyous",
            "Painstaking",
            "Fragile",
            "Quickest",
            "Self-assured",
            "Sensitive",
            "Slippery",
            "Unassuming",
            "Emotional",
            "Passive",
            "Center",
            "Swift",
            "Volcanic",
            "Reliable",
            "Squeamish",
            "Elated",
            "Resonant",
            "Scrawny",
            "Deviant",
            "Striped",
            "Diplomatic",
            "Sneaky",
            "Misty",
            "Believing",
            "Easy",
            "Breeze",
            "Fanlike",
            "Hilarious",
            "Fainthearted",
            "Good",
            "Slimy",
            "Borderline",
            "Odd",
            "Snobby",
            "Even-tempered",
            "Snazzy",
            "Disguised",
            "Moronic",
            "Meticulous",
            "Central american",
            "Rotten",
            "Blindfolded",
            "Orderly",
            "Credulous",
            "Unpopular",
            "Many",
            "Misbehaving",
            "Gleaming",
            "Maternal",
            "Divine",
            "All-night",
            "Cheering",
            "Narrow",
            "Fresh",
            "Awesome",
            "Glued",
            "Industrious",
            "Moonlit",
            "Calm",
            "Chivalrous",
            "Composed",
            "Twisted",
            "Lame",
            "Sincere",
            "Distinct",
            "Muddy",
            "Cheerful",
            "Likeable",
            "Efficient",
            "Thoughtless",
            "Jolly",
            "Short",
            "Optimistic",
            "Frank",
            "Haunted",
            "Drugged",
            "Unthinking",
            "Horrible",
            "Impressive",
            "Late",
            "Excellent",
            "Difficult",
            "Hesitant",
            "Quick",
            "Barbaric",
            "Ordinary",
            "Chintzy",
            "Glutinous",
            "Bungling",
            "Restless",
            "Stupid",
            "Motivated",
            "Silly",
            "Demoralized",
            "Healing",
            "Mighty",
            "Head-on",
            "Curly",
            "Artistic",
            "Ugliest",
            "Immodest",
            "Dangerous",
            "Hysterical",
            "Shrill",
            "Broad-minded",
            "Annoyed",
            "Coal-fired",
            "Morose",
            "Brokenhearted",
            "Resourceful",
            "Boiling",
            "Shallow",
            "Honorable",
            "Distant",
            "Condescending",
            "Deadpan",
            "Angry",
            "Brainy",
            "Evil",
            "Free",
            "Green",
            "Bitter",
            "Fluffy",
            "Vigilant",
            "Husky",
            "Disturbed",
            "Inspiring",
            "Prudent",
            "Outrageous",
            "Dowdy",
            "Gregarious",
            "Spine-chilling",
            "Steady",
            "Hawaiian",
            "Sympathetic",
            "Distrustful",
            "Incisive",
            "Blessed",
            "Unsure",
            "Sophisticated",
            "Instinctive",
            "Bean-shaped",
            "Half-dozen",
            "Ratty",
            "Grouchy",
            "Coincidental",
            "Well-respected",
            "Itchy",
            "Keen",
            "Dark",
            "Hypercritical",
            "Lively",
            "Exclusive",
            "Chilly",
            "Dry",
            "Icy",
            "High",
            "Clenched",
            "Annoying",
            "Independent",
            "Pokey",
            "Super",
            "Dramatic",
            "Heavy",
            "Logical",
            "Above average",
            "Shaggy",
            "Irresistible",
            "High-priced",
            "Testy",
            "Genuine",
            "Eager",
            "Sullen",
            "Fair-minded",
            "Stable",
            "Attracted",
            "Patient",
            "Tricky",
            "Involved",
            "Ghostly",
            "Wary",
            "Healthy",
            "Experienced",
            "Pensive",
            "Squealing",
            "Cool",
            "Flashy",
            "Kooky",
            "Dated",
            "Different",
            "Uninterested",
            "Cheesy",
            "Moody",
            "Greasy",
            "Smelly",
            "Bare-ass",
            "Homely",
            "Stormy",
            "Disappointed",
            "Disagreeable",
            "Bad",
            "Engrossed",
            "Witty",
            "Caustic",
            "Timid",
            "Flowing",
            "Clever",
            "Proud",
            "Knowledgeable",
            "Doubtful",
            "Productive",
            "Early",
            "Eye-deceiving",
            "Appreciative",
            "Hearty",
            "Grubby",
            "Grade-appropriate",
            "Polite",
            "Dainty",
            "Endurable",
            "Empowering",
            "Stern",
            "Grave",
            "Cautious",
            "Inquisitive",
            "Shrewd",
            "Bored",
            "Disruptive",
            "Weak",
            "Idiotic",
            "Low",
            "Unreliable",
            "Unguarded",
            "Deaf-and-dumb",
            "Assertive",
            "Boisterous",
            "Hardheaded",
            "Unbalanced",
            "Cooperative",
            "Agreeable",
            "Steep",
            "Shocking",
            "Persevering",
            "Quick-tempered",
            "Elderly",
            "Rough",
            "Hungry",
            "Repulsive",
            "Kind",
            "Striking",
            "Ostentatious",
            "Dark-gray",
            "Expectant",
            "Grotesque",
            "Monster",
            "Reserved",
            "Extreme",
            "Modest",
            "Leery",
            "Placid",
            "Ashamed",
            "Sentimental",
            "Ridiculous",
            "Incompetent",
            "Chicken",
            "Happy-go-lucky",
            "Weary",
            "Mushy",
            "Dusty",
            "Quick-witted",
            "Enterprising",
            "Insensitive",
            "Spontaneous",
            "Steadfast",
            "Mammoth",
            "Faithful",
            "Sensible",
            "Plain",
            "Sexy",
            "Devoted",
            "Discerning",
            "Fanciful",
            "Raspy",
            "Combustive",
            "Communicative",
            "Receptive",
            "Lethargic",
            "Young",
            "Brief",
            "Vigorous",
            "Exuberant",
            "Enlightened",
            "Expedient",
            "Hot-headed",
            "Big",
            "Damn",
            "Petulant",
            "Screeching",
            "Cool-headed",
            "Righteous",
            "Spinning",
            "Prickly",
            "Beneficent",
            "Nervous",
            "All-round",
            "Straightforward",
            "Broad",
            "Intuitive",
            "Geometrical",
            "Loyal",
            "Revolting",
            "Magic",
            "Credal",
            "Miniature",
            "Combinable",
            "Unpleasant",
            "Affectionate",
            "Smokey",
            "Enchanting",
            "Glinting",
            "Uptight",
            "Slothful",
            "Unfriendly",
            "Capable",
            "Successful",
            "Petite",
            "Controlling",
            "Outspoken",
            "Deafening",
            "Gory",
            "Tender",
            "Triple",
            "Shy",
            "Demonic",
            "Fine",
            "Stained",
            "Upset",
            "Grim",
            "Apprehensive",
            "Plucky",
            "Chaotic",
            "Local",
            "Made-up",
            "Seemly",
            "Plain-speaking",
            "Numerous",
            "Stale",
            "Colossal",
            "Tight",
            "Ancient",
            "Defeated",
            "High-level",
            "Cordial",
            "Juicy",
            "Rainy",
            "Cobwebby",
            "Boney",
            "Sociable",
            "Excitable",
            "Vulnerable",
            "Hallucinating",
            "Snooping",
            "Spotless",
            "Succinct",
            "Big-shouldered",
            "Protective",
            "Empowered",
            "Brilliant",
            "Nosy",
            "Ugly",
            "Conceited",
            "Bloodcurdling",
            "Understanding",
            "Unimaginative",
            "Harmless",
            "Burned-out",
            "Crucial",
            "Gracious",
            "Heartbroken",
            "Resigned",
            "Condemned",
            "Dead on target",
            "Hot",
            "Joyful",
            "Dependent",
            "Blushing",
            "Poised",
            "Sparkling",
            "Unstable",
            "Superficial",
            "Wandering",
            "Wild",
            "Thankful",
            "Level-headed",
            "Indolent",
            "Purring",
            "Resolute",
            "Stinky",
            "Adorable",
            "Practical",
            "Alarming",
            "Thundering",
            "Easy-going",
            "Lovable",
            "Insane",
            "Attractive",
            "Breakable",
            "Hollow",
            "Chic",
            "Damaged",
            "High-powered",
            "Conscientious",
            "Honest-to-goodness",
            "Very well",
            "Spastic",
            "Bullying",
            "Worried",
            "Neat",
            "Drooling",
            "Whispering",
            "Daredevil",
            "Provocative",
            "Dextrous",
            "Reflective",
            "Barbecued",
            "Serene",
            "Best-known",
            "Gigantic",
            "Tough",
            "Indefatigable",
            "Frightened",
            "Alluring",
            "Sulky",
            "Ghoulish",
            "Suspicious",
            "Naked",
            "Mild",
            "Saucy",
            "Cranky",
            "Respected",
            "Serious",
            "Plastic",
            "Grieving",
            "Pioneering",
            "Crafty",
            "Bewildered",
            "Bell-bottom",
            "Boundless",
            "Bare-assed",
            "Below average",
            "Best-selling",
            "Sassy",
            "Cultured",
            "Courageous",
            "Heart-healthy",
            "Worrisome",
            "Intolerant",
            "Devilish",
            "Direct",
            "Embarrassed",
            "Stingy",
            "Numb",
            "Perfect",
            "Mature",
            "Foolish",
            "Groping",
            "Childish",
            "Quiet",
            "Sleepy",
            "Graceful",
            "Roasted",
            "Large",
            "Paternalistic",
            "Churlish",
            "Frightful",
            "Dutiful",
            "Gifted",
            "Demure",
            "Crowded",
            "Easy going",
            "Well",
            "Healthful",
            "Fiery",
            "Pretty",
            "Critical",
            "Peevish",
            "Damned",
            "Belligerent",
            "Defiant",
            "Drowsy",
            "Methodical",
            "Gossipy",
            "Half-size",
            "Robust",
            "Philosophical",
            "Carved",
            "Blind drunk",
            "Creepy",
            "Agile",
            "Dark-fruited",
            "Spooky",
            "Fast",
            "Blunt",
            "Clean",
            "Overjoyed",
            "Gullible",
            "Fuzzy",
            "Liking",
            "Dull",
            "Bighearted",
            "Deep",
            "Kind-hearted",
            "Dizzy",
            "Quaint",
            "Combative",
            "Cold sober",
            "Compassionate",
            "Rare",
            "Coldhearted",
            "Startling",
            "Musical",
            "Entertaining",
            "Festive",
            "Warmhearted",
            "Combined",
            "Sizzling",
            "Comfortable",
            "Masked",
            "Gloomy",
            "Inventive",
            "Wicked",
            "Old-fashioned",
            "Broken",
            "Sturdy",
            "Chilling",
            "Envious",
            "Gentle",
            "Stylish",
            "Puny",
            "Amiable",
            "Innocent",
            "Imaginative",
            "Frightening",
            "Slovenly",
            "Darkish",
            "Pleasant",
            "Somber",
            "Moaning",
            "Hairy",
            "Zany",
            "Sudden",
            "Peaceful",
            "Cute",
            "Harsh",
            "Sweet",
            "Negative",
            "Pointed",
            "Wooden",
            "Ill",
            "Circumspect",
            "Flat",
            "Solid",
            "Supportive",
            "Shaky",
            "Tactless",
            "Uneven",
            "Glamorous",
            "Obedient",
            "Depressed",
            "Elfin",
            "Competent",
            "Listless",
            "Lusting",
            "Guarded",
            "Dirty",
            "Hateful",
            "Gritty",
            "Undependable",
            "Blue-eyed",
            "Cloudy",
            "Quarrelsome",
            "Excited",
            "Glottal",
            "Realistic",
            "Alien",
            "Determined",
            "Fancy-free",
            "Civil",
            "Blinding",
            "Attentive",
            "Shivering",
            "Responsible",
            "Dreadful",
            "Clinical",
            "Interesting",
            "Detailed",
            "Amicable",
            "Exacting",
            "Playful",
            "Breezy",
            "Irascible",
            "Prejudiced",
            "Thinking",
            "Fat",
            "Geographic",
            "Surly",
            "Curious",
            "Teasing",
            "Silent",
            "Centralized",
            "Supernatural",
            "Warm",
            "Encouraging",
            "Diligent",
            "Well-rounded",
            "Staid",
            "Precious",
            "Black-and-tan",
            "Bizarre",
            "Nice",
            "Watery",
            "Painful",
            "Judgmental",
            "Mute",
            "Amused",
            "Inexpensive",
            "Picky",
            "Forceful",
            "Handsome",
            "Impartial",
            "Better",
            "Sour",
            "Modern",
            "British",
            "Subtle",
            "Curved",
            "Howling",
            "Shadowy",
            "Ambitious",
            "Adventurous",
            "Combinatory",
            "Morbid",
            "Dynamic",
            "Abnormal",
            "Skinny",
            "Cruel",
            "Pride",
            "Naughty",
            "Tasteless",
            "Hippie",
            "Handwritten",
            "Little",
            "Comatose",
            "Motionless",
            "Meddlesome",
            "Mysterious",
            "Talented",
            "Tactful",
            "Bushy",
            "Guilt-ridden",
            "Gruesome",
            "Cold",
            "Inactive",
            "Angelic",
            "Giant",
            "Empty",
            "Yummy",
            "Long",
            "Overcome",
            "Glistening",
            "Evasive",
            "Dashing",
            "Biweekly",
            "Stimulating",
            "Smart",
            "Otherworldly",
            "Gobsmacked",
            "Brave",
            "Unnatural",
            "Lovely",
            "Real",
            "Proficient",
            "Thrilled",
            "Bold",
            "Blissful",
            "Fair-and-square",
            "Square",
            "Lucky",
            "Light",
            "Fair",
            "Happy",
            "Querulous",
            "Tidy",
            "Love-lorn",
            "Buff",
            "Thrilling",
            "Silky",
            "Vivacious",
            "Careful",
            "Yellow",
            "Chancy",
            "Cowardly",
            "Charming",
            "Gasping",
            "Important",
            "Pro-active",
            "Candid",
            "Powerful",
            "Afraid",
            "Decisive",
            "Grisly",
            "Beetle-browed",
            "Wide-eyed",
            "Fantabulous",
            "Half-crazed",
            "Imperturbable",
            "Smooth",
            "Wrong",
            "Selfish",
            "Harmonious",
            "Unsightly",
            "Clear",
            "Screaming",
            "Unemotional",
            "Romantic",
            "Distraught",
            "Unnerving",
            "Cuddly",
            "Hair-raising",
            "Clumsy",
            "Loose",
            "Concerned",
            "Delicious",
            "Beatable",
            "Positive",
            "Careless",
            "Dazzling",
            "Passionate",
            "Sedate",
            "Disgusted",
            "Factory-made",
            "Jittery",
            "Inconsiderate",
            "Touchy",
            "Obnoxious",
            "Lonely",
            "Demolished",
            "Voiceless",
            "Closed-circuit",
            "Freezing",
            "Indiscreet",
            "Warming",
            "Frail",
            "Strong",
            "Colorful",
            "Sneering",
            "Credible",
            "Versatile",
            "Sloppy",
            "Thoughtful",
            "Tranquil",
            "Dead-on",
            "Enthusiastic",
            "Unearthly",
            "Tolerant",
            "Busy",
            "Thrifty",
            "Upbeat",
            "Nutty",
            "Rich",
            "Magnificent",
            "Victorious",
            "Easygoing",
            "Farming",
            "Spicy",
            "Salty",
            "Crabby",
            "Relieved",
            "Friendly",
            "Cantankerous",
            "Grumpy",
            "Aggressive",
            "Unmotivated",
            "Purple",
            "Eye-rolling",
            "Crystal clear",
            "Immature",
            "Zealous",
            "Combustible",
            "Resentful",
            "Cherry-sized",
            "Well-developed",
            "Reassuring",
            "Dead",
            "Unhelpful",
            "Smoggy",
            "Confident",
            "Inconsistent",
            "Fastidious",
            "Immense",
            "Heartsick",
            "Well-intentioned",
            "Expensive",
            "Nasty",
            "Beaten",
            "Honest-to-god",
            "Dog like",
            "Level",
            "Melodic",
            "Candy",
            "God-awful",
            "Fortunate",
            "Beefed-up",
            "Awful",
            "Hard-working",
            "Smiling",
            "Unsophisticated",
            "Exasperating",
            "Hissing",
            "Tasty",
            "Jealous",
            "Tiny",
            "Delightful",
            "Self-disciplined",
            "Fierce",
            "Scattered",
            "Damp",
            "Sticky",
            "Frantic",
            "Reluctant",
            "Chewable",
            "Staring",
            "Considerate",
            "Ghastly",
            "Wide",
            "Coherent",
            "Cloak-and-dagger",
            "Impatient",
            "Impulsive",
            "Eminent",
            "Miserable",
            "Terrifying",
            "Slow",
            "Bumpy",
            "Bright",
            "Tall",
            "Awkward",
            "Filthy",
            "Wet",
            "Elegant",
            "Animated",
            "Outgoing",
            "Weird",
            "Hairless",
            "Belated",
            "Bone-dry",
            "Groveling",
            "Combatant",
            "Fusion",
            "Alert",
            "Mean",
            "Make-believe",
            "Faith",
            "Troubled",
            "Handsewn",
            "Fighting",
            "Sore",
            "Humorous",
            "Cold-blooded",
            "Amazing",
            "Impractical",
            "Unwilling",
            "Fancy",
            "Supercilious",
            "Long-winded",
            "Open",
            "Revered",
            "Huge",
            "Energetic",
            "Rapid",
            "Rational",
            "Crazy",
            "Glorious",
            "Fantastic",
            "Uncooperative",
            "Mercurial",
            "Fussy",
            "Uncertain",
            "Heartfelt",
            "Normal",
            "Massive",
            "Watchful",
            "New",
            "Delicate",
            "Beautiful",
            "Extraordinary",
            "Sharp",
            "Bigheaded",
            "Honest",
            "Crooked",
            "Eerie",
            "Amusing",
            "Best",
            "Anxious",
            "Discreet",
            "Self-confident",
            "Soulless",
            "Ripe",
            "Intent",
            "Balanced",
            "Punctual",
            "Flaky",
            "Goosey",
            "Willing",
            "Spirited",
            "Loud",
            "Groggy",
            "Breathless",
            "Courteous",
            "Inappropriate",
            "Spotty",
            "Generous",
            "Amazed",
            "Puzzled",
            "Drunk",
            "Businesslike",
            "Unusual",
            "Flighty",
            "Hallucinogenic",
            "Distracted",
            "Straight"

        };

        static Random randomGenerator = new Random((int)DateTime.Now.Ticks);

        /// <summary>
        /// Returns a random name for a desktop, that accomplishes the intersectPredicate
        /// </summary>
        /// <param name="intersectPredicate">Select all the elements that make this predicate true</param>
        /// <returns></returns>
        public static string Random(Func<string, bool> intersectPredicate)
        {
            string[] namesLeft = names.Where((n) => intersectPredicate(n+ " desktop")).ToArray();
            int length = namesLeft.Length;
            if (length == 0) // Incredible, you have created 1000 desktops or more
            {
                ulong index = 1; // Would you be able to create more than ulong's size - 1 desktops ?
                while (true)
                {
                    string newName = $"Desktop 1+1={index++}";
                    if (intersectPredicate(newName)) return newName;
                }
            }
            return namesLeft[randomGenerator.Next(length)] + " desktop";
        }

        public static string Random(string desktopsFolder)
        {
            return Random((name) =>
            {
                string escapedName = Desktop.GetEscapedName(name);
                string path = System.IO.Path.Combine(desktopsFolder, escapedName);
                return !System.IO.File.Exists(path) && !System.IO.Directory.Exists(path);
            });
        }

        public static string Random()
        {
            return Random(Desktop.GetAnyDesktopFolder());
        }

    }
}
